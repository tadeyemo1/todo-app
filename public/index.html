<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>To-Do List</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>My To-Do List</h1>
  <form id="todo-form">
    <input type="text" id="todo-input" placeholder="New task..." required />
    <button type="submit">Add</button>
  </form>
  <ul id="todo-list"></ul>

  <script>
    async function fetchTodos() {
      const res = await fetch("/todos");
      const todos = await res.json();
      const list = document.getElementById("todo-list");
      list.innerHTML = "";

      todos.forEach((todo) => {
        const li = document.createElement("li");

        // Checkbox
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.checked = todo.completed === 1;
        checkbox.addEventListener("change", async () => {
          await fetch(`/todos/${todo.id}/complete`, { method: "PUT" });
          fetchTodos();
        });
        li.appendChild(checkbox);

        // Task Text
        const taskText = document.createElement("span");
        taskText.textContent = " " + todo.task;
        taskText.style.margin = "0 8px";
        li.appendChild(taskText);

        // Edit Button
        const editBtn = document.createElement("button");
        editBtn.textContent = "Edit";
        editBtn.onclick = async () => {
          const newTask = prompt("Edit task:", todo.task);
          if (newTask) {
            await fetch(`/todos/${todo.id}`, {
              method: "PUT",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ task: newTask }),
            });
            fetchTodos();
          }
        };
        li.appendChild(editBtn);

        // Delete Button
        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "Delete";
        deleteBtn.onclick = async () => {
          await fetch(`/todos/${todo.id}`, { method: "DELETE" });
          fetchTodos();
        };
        deleteBtn.style.marginLeft = "6px";
        li.appendChild(deleteBtn);

        list.appendChild(li);
      });
    }

    document
      .getElementById("todo-form")
      .addEventListener("submit", async (e) => {
        e.preventDefault();
        const input = document.getElementById("todo-input");
        await fetch("/todos", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ task: input.value }),
        });
        input.value = "";
        fetchTodos();
      });

    fetchTodos();
  </script>
</body>
</html>


